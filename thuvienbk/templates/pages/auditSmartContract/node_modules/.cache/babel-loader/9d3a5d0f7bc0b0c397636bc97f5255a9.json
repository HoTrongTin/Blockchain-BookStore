{"ast":null,"code":"import _defineProperty from \"/home/bnbaotam/Desktop/Bookstore-Blockchain/thuvienbk/templates/pages/auditSmartContract/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/bnbaotam/Desktop/Bookstore-Blockchain/thuvienbk/templates/pages/auditSmartContract/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/bnbaotam/Desktop/Bookstore-Blockchain/thuvienbk/templates/pages/auditSmartContract/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/bnbaotam/Desktop/Bookstore-Blockchain/thuvienbk/templates/pages/auditSmartContract/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/bnbaotam/Desktop/Bookstore-Blockchain/thuvienbk/templates/pages/auditSmartContract/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/bnbaotam/Desktop/Bookstore-Blockchain/thuvienbk/templates/pages/auditSmartContract/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/bnbaotam/Desktop/Bookstore-Blockchain/thuvienbk/templates/pages/auditSmartContract/src/MainPage.js\";\nimport React, { Component } from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport { withStyles } from '@material-ui/core/styles';\nimport PropTypes from 'prop-types';\nimport Paper from '@material-ui/core/Paper';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport Review from './Review.js';\nimport axios from 'axios';\nimport Link from '@material-ui/core/Link';\nimport ExchangeBox from './ExchangeBox.js';\nimport Web3 from 'web3';\nvar web3 = new Web3(new Web3.providers.WebsocketProvider(\"ws://localhost:7545\"));\n\nvar styles = function styles(theme) {\n  return {\n    root: {\n      margin: \"auto\",\n      marginTop: theme.spacing.unit * 10,\n      paddingTop: theme.spacing.unit * 2,\n      paddingBottom: theme.spacing.unit * 2,\n      paddingLeft: theme.spacing.unit * 2,\n      paddingRight: theme.spacing.unit * 2,\n      width: \"95%\"\n    },\n    container: {\n      display: 'inline',\n      flexWrap: 'wrap'\n    },\n    textField: {\n      marginLeft: theme.spacing.unit,\n      marginRight: theme.spacing.unit,\n      width: \"100%\"\n    },\n    layoutTransaction: {\n      paddingTop: theme.spacing.unit * 2,\n      paddingBottom: theme.spacing.unit * 2,\n      paddingLeft: theme.spacing.unit * 2,\n      paddingRight: theme.spacing.unit * 2,\n      marginTop: theme.spacing.unit * 3,\n      marginBottom: theme.spacing.unit * 3,\n      marginLeft: \"20%\",\n      marginRight: \"20%\"\n    },\n    button: {\n      margin: theme.spacing.unit\n    },\n    fab: {\n      margin: theme.spacing.unit * 2\n    },\n    rightIcon: {\n      margin: theme.spacing.unit\n    }\n  };\n};\n\nvar IP_address = \"172.28.247.94\";\nvar escrowContract = new web3.eth.Contract([{\n  \"constant\": false,\n  \"inputs\": [{\n    \"name\": \"_from\",\n    \"type\": \"address\"\n  }, {\n    \"name\": \"_to\",\n    \"type\": \"address\"\n  }, {\n    \"name\": \"ether_amount\",\n    \"type\": \"uint256\"\n  }],\n  \"name\": \"sendeth\",\n  \"outputs\": [],\n  \"payable\": true,\n  \"stateMutability\": \"payable\",\n  \"type\": \"function\",\n  \"funcName\": \"sendeth(address,address,uint256)\",\n  \"signature\": \"0x5ff49ce3\"\n}, {\n  \"constant\": false,\n  \"inputs\": [{\n    \"name\": \"_from\",\n    \"type\": \"address\"\n  }, {\n    \"name\": \"_to\",\n    \"type\": \"address\"\n  }, {\n    \"name\": \"_tokenAddress\",\n    \"type\": \"address\"\n  }, {\n    \"name\": \"token_amount\",\n    \"type\": \"uint256\"\n  }],\n  \"name\": \"sendtoken\",\n  \"outputs\": [],\n  \"payable\": false,\n  \"stateMutability\": \"nonpayable\",\n  \"type\": \"function\",\n  \"funcName\": \"sendtoken(address,address,address,uint256)\",\n  \"signature\": \"0xe5a1f214\"\n}, {\n  \"inputs\": [],\n  \"payable\": false,\n  \"stateMutability\": \"nonpayable\",\n  \"type\": \"constructor\",\n  \"signature\": \"constructor\"\n}, {\n  \"anonymous\": false,\n  \"inputs\": [{\n    \"indexed\": false,\n    \"name\": \"number_line\",\n    \"type\": \"uint256\"\n  }],\n  \"name\": \"check\",\n  \"type\": \"event\",\n  \"funcName\": \"check(uint256)\",\n  \"signature\": \"0x5f72f450c381493c8b88f0bcbf2bbe88a1ad56665696daa7cb7349917afdd320\"\n}], \"0xE5a1EA9bEEd9c050ad16EB656F21612309DF2aD9\");\nvar tokenContract = new web3.eth.Contract([{\n  \"constant\": true,\n  \"inputs\": [],\n  \"name\": \"name\",\n  \"outputs\": [{\n    \"name\": \"\",\n    \"type\": \"string\"\n  }],\n  \"payable\": false,\n  \"stateMutability\": \"view\",\n  \"type\": \"function\",\n  \"funcName\": \"name()\",\n  \"signature\": \"0x06fdde03\"\n}, {\n  \"constant\": false,\n  \"inputs\": [{\n    \"name\": \"_spender\",\n    \"type\": \"address\"\n  }, {\n    \"name\": \"tokens\",\n    \"type\": \"uint256\"\n  }],\n  \"name\": \"approve\",\n  \"outputs\": [{\n    \"name\": \"success\",\n    \"type\": \"bool\"\n  }],\n  \"payable\": false,\n  \"stateMutability\": \"nonpayable\",\n  \"type\": \"function\",\n  \"funcName\": \"approve(address,uint256)\",\n  \"signature\": \"0x095ea7b3\"\n}, {\n  \"constant\": false,\n  \"inputs\": [{\n    \"name\": \"_from\",\n    \"type\": \"address\"\n  }, {\n    \"name\": \"_to\",\n    \"type\": \"address\"\n  }, {\n    \"name\": \"tokens\",\n    \"type\": \"uint256\"\n  }],\n  \"name\": \"transferFrom\",\n  \"outputs\": [{\n    \"name\": \"success\",\n    \"type\": \"bool\"\n  }],\n  \"payable\": false,\n  \"stateMutability\": \"nonpayable\",\n  \"type\": \"function\",\n  \"funcName\": \"transferFrom(address,address,uint256)\",\n  \"signature\": \"0x23b872dd\"\n}, {\n  \"constant\": true,\n  \"inputs\": [],\n  \"name\": \"decimals\",\n  \"outputs\": [{\n    \"name\": \"\",\n    \"type\": \"uint8\"\n  }],\n  \"payable\": false,\n  \"stateMutability\": \"view\",\n  \"type\": \"function\",\n  \"funcName\": \"decimals()\",\n  \"signature\": \"0x313ce567\"\n}, {\n  \"constant\": true,\n  \"inputs\": [{\n    \"name\": \"_tokenOwner\",\n    \"type\": \"address\"\n  }],\n  \"name\": \"balanceOf\",\n  \"outputs\": [{\n    \"name\": \"\",\n    \"type\": \"uint256\"\n  }],\n  \"payable\": false,\n  \"stateMutability\": \"view\",\n  \"type\": \"function\",\n  \"funcName\": \"balanceOf(address)\",\n  \"signature\": \"0x70a08231\"\n}, {\n  \"constant\": true,\n  \"inputs\": [],\n  \"name\": \"symbol\",\n  \"outputs\": [{\n    \"name\": \"\",\n    \"type\": \"string\"\n  }],\n  \"payable\": false,\n  \"stateMutability\": \"view\",\n  \"type\": \"function\",\n  \"funcName\": \"symbol()\",\n  \"signature\": \"0x95d89b41\"\n}, {\n  \"constant\": false,\n  \"inputs\": [{\n    \"name\": \"_to\",\n    \"type\": \"address\"\n  }, {\n    \"name\": \"tokens\",\n    \"type\": \"uint256\"\n  }],\n  \"name\": \"transfer\",\n  \"outputs\": [{\n    \"name\": \"success\",\n    \"type\": \"bool\"\n  }],\n  \"payable\": false,\n  \"stateMutability\": \"nonpayable\",\n  \"type\": \"function\",\n  \"funcName\": \"transfer(address,uint256)\",\n  \"signature\": \"0xa9059cbb\"\n}, {\n  \"constant\": true,\n  \"inputs\": [{\n    \"name\": \"tokenOwner\",\n    \"type\": \"address\"\n  }, {\n    \"name\": \"spender\",\n    \"type\": \"address\"\n  }],\n  \"name\": \"allowance\",\n  \"outputs\": [{\n    \"name\": \"remaining\",\n    \"type\": \"uint256\"\n  }],\n  \"payable\": false,\n  \"stateMutability\": \"view\",\n  \"type\": \"function\",\n  \"funcName\": \"allowance(address,address)\",\n  \"signature\": \"0xdd62ed3e\"\n}, {\n  \"inputs\": [],\n  \"payable\": false,\n  \"stateMutability\": \"nonpayable\",\n  \"type\": \"constructor\",\n  \"signature\": \"constructor\"\n}, {\n  \"anonymous\": false,\n  \"inputs\": [{\n    \"indexed\": true,\n    \"name\": \"from\",\n    \"type\": \"address\"\n  }, {\n    \"indexed\": true,\n    \"name\": \"to\",\n    \"type\": \"address\"\n  }, {\n    \"indexed\": false,\n    \"name\": \"tokens\",\n    \"type\": \"uint256\"\n  }],\n  \"name\": \"Transfer\",\n  \"type\": \"event\",\n  \"funcName\": \"Transfer(address,address,uint256)\",\n  \"signature\": \"0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\"\n}, {\n  \"anonymous\": false,\n  \"inputs\": [{\n    \"indexed\": true,\n    \"name\": \"tokenOwner\",\n    \"type\": \"address\"\n  }, {\n    \"indexed\": true,\n    \"name\": \"spender\",\n    \"type\": \"address\"\n  }, {\n    \"indexed\": false,\n    \"name\": \"tokens\",\n    \"type\": \"uint256\"\n  }],\n  \"name\": \"Approval\",\n  \"type\": \"event\",\n  \"funcName\": \"Approval(address,address,uint256)\",\n  \"signature\": \"0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925\"\n}], \"0xb4D6d66d76896D99F0A52c8d6C010cEb401F9d5A\");\ntokenContract.events.allEvents(function (error, event) {\n  if (error) {\n    console.error(error);\n    return false;\n  }\n\n  console.log(event);\n});\nescrowContract.events.allEvents(function (error, event) {\n  if (error) {\n    console.error(error);\n    return false;\n  }\n\n  console.log(event);\n});\n\nvar mainPage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(mainPage, _Component);\n\n  function mainPage(props) {\n    var _this;\n\n    _classCallCheck(this, mainPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(mainPage).call(this, props));\n\n    _this.callAjax_sendTransaction = function () {\n      console.log(\"send\");\n\n      if (_this.state.contextTransaction !== \"\" && _this.state.sender !== \"\") {\n        axios.post(\"http://\".concat(IP_address, \":3001/sendTransaction\"), {\n          senderName: _this.state.userName,\n          transaction: _this.state.contextTransaction\n        }).then(function (res) {\n          console.log(res.data);\n        });\n      }\n    };\n\n    _this.callAjax_backtohome = function () {};\n\n    _this.callAjax_validate = function () {\n      axios.post(\"http://\".concat(IP_address, \":3001/validate\"), {\n        transactions: _this.state.transactions.map(function (transaction) {\n          return transaction.transaction;\n        }).join(\"\")\n      }).then(function (res) {\n        console.log(res.data);\n\n        _this.setState({\n          \"responseState\": res.data\n        });\n      });\n    };\n\n    _this.sendethFunc = function (_from, _to, amount) {\n      console.log(\"send eth \" + _from + \" \" + _to + \" \" + amount);\n      escrowContract.methods.sendeth(_from, _to, web3.utils.toWei(amount, 'ether').toString()).send({\n        from: _from,\n        gasPrice: \"100000000000\",\n        gas: \"4712388\",\n        value: web3.utils.toWei(amount, 'ether').toString()\n      }).on('transactionHash', function (hash) {\n        console.log(hash);\n      });\n    };\n\n    _this.sendtokenFunc = function (_from, _to, token_address, amount) {\n      console.log(\"send token \" + _from + \" \" + _to + \" \" + token_address + \" \" + amount);\n      escrowContract.methods.sendtoken(_from, _to, token_address, amount).send({\n        from: _from,\n        gasPrice: \"100000000000\",\n        gas: \"4712388\"\n      }).on('transactionHash', function (hash) {\n        console.log(hash);\n      });\n    };\n\n    _this.sendTransaction = function (transaction_1) {\n      var transaction;\n      console.log(\"aaaaaa\");\n\n      if (_this.state.responseState !== '') {\n        var responseState = _this.state.responseState;\n        transaction = responseState.filter(function (transac) {\n          console.log(transac.transaction.text, transaction_1.slice(0, transaction_1.length - 1));\n          return transac.transaction.text === transaction_1.slice(0, transaction_1.length - 1);\n        }); // console.log(JSON.stringify(transaction));\n\n        transaction = transaction[0].transaction; // console.log(\"#\"+ transaction);\n\n        if (transaction.type === \"sendeth\") {\n          _this.sendethFunc(transaction._from, transaction._to, transaction.amount);\n        } else if (transaction.type === \"sendtoken\") {\n          console.log(transaction); // token thừa , và khaognr trống , phải bỏ đi\n\n          _this.sendtokenFunc(transaction._from, transaction._to, transaction.address_token.slice(1, transaction.address_token.length - 1), transaction.amount);\n        } else {\n          console.log(\"line 161\");\n        }\n      }\n    };\n\n    _this.sendToken = function () {// escrowContract.methods.sendeth(\"0x6462a0ab9e11F8B47ee153e46E4c3f5f9593ece0\",\"0x8D26738a7bECC37ed5D100639d080FB9835E1008\",web3.utils.toWei(\"1\",\"ether\").toString())\n      //     .send({from : \"0x6462a0ab9e11F8B47ee153e46E4c3f5f9593ece0\", gasPrice : \"100000000000\", gas : \"4712388\", value : web3.utils.toWei(\"1\",\"ether\").toString()})\n      //     .on('transactionHash', (hash) => {\n      //         console.log(hash);\n      //     });\n      // escrowContract.methods.sendtoken(\"0x8D26738a7bECC37ed5D100639d080FB9835E1008\",\"0x6462a0ab9e11F8B47ee153e46E4c3f5f9593ece0\",\"0xb4D6d66d76896D99F0A52c8d6C010cEb401F9d5A\", \"10000\")\n      //     .send({from : \"0x8D26738a7bECC37ed5D100639d080FB9835E1008\", gasPrice : \"100000000000\", gas : \"3200000\"})\n      //     .then(res => {\n      //         console.log(\"@@@\"+JSON.stringify(res));\n      //     })\n      //     .catch(error  => {\n      //         console.log(error);\n      //     });\n      // tokenContract.methods.balanceOf(\"0x6462a0ab9e11F8B47ee153e46E4c3f5f9593ece0\")\n      //     .call({from: \"0x6462a0ab9e11F8B47ee153e46E4c3f5f9593ece0\", gasPrice: \"100000000000\", gas: \"4712388\"})\n      //     .then( res => {\n      //         console.log(\"# \" +res);\n      //     });\n      // tokenContract.methods.transfer(\"0x8D26738a7bECC37ed5D100639d080FB9835E1008\", \"100000000\")\n      //     .send({from: \"0x87616A71Ae0B412e402D846fae89dBF57a32031e\", gasPrice: \"100000000000\", gas: \"4712388\"})\n      //     .on('transactionHash', (hash) => {\n      //         console.log(hash);\n      //     })\n      // tokenContract.methods.approve(\"0xE5a1EA9bEEd9c050ad16EB656F21612309DF2aD9\",\"10000\")\n      //     .send({from: \"0x8D26738a7bECC37ed5D100639d080FB9835E1008\", gasPrice: \"100000000000\", gas: \"4712388\"})\n      //     .then( res => {\n      //         console.log(\"# \" +res);\n      //     });\n      // tokenContract.methods.allowance(\"0x8D26738a7bECC37ed5D100639d080FB9835E1008\",\"0xE5a1EA9bEEd9c050ad16EB656F21612309DF2aD9\")\n      //     .call({from: \"0x8D26738a7bECC37ed5D100639d080FB9835E1008\", gasPrice: \"100000000000\", gas: \"4712388\"})\n      //     .then( res => {\n      //         console.log(\"# \" +res);\n      //     });\n      //\n      // tokenContract.methods.transferFrom(\"0x8D26738a7bECC37ed5D100639d080FB9835E1008\",\"0x30D75Ed05305A0EEB230f2f8adDE680897751fF0\",\"10000\")\n      //     .send({from: \"0x30D75Ed05305A0EEB230f2f8adDE680897751fF0\", gasPrice: \"100000000000\", gas: \"4712388\"})\n      //     .then( res => {\n      //         console.log(\"# \" +res);\n      //     });\n      // web3.eth.sendTransaction({\n      //     from: \"0x87616A71Ae0B412e402D846fae89dBF57a32031e\",\n      //     to: \"0xb71381649157D04DDAde46263498218CCDA74C54\",\n      //\n      //     value: web3.utils.toWei(\"3\",\"ether\")\n      // })\n    };\n\n    _this.handleChange = function (prop) {\n      return function (event) {\n        _this.setState(_defineProperty({}, prop, event.target.value));\n      };\n    };\n\n    _this.state = {\n      contextTransaction: '',\n      responseState: [],\n      transactions: [],\n      userName: '',\n      tokenAddress: '',\n      checkValidate: ''\n    };\n    var myContract = '';\n    return _this;\n  }\n\n  _createClass(mainPage, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      setInterval(function () {\n        axios.get(\"http://\".concat(IP_address, \":3001/refresh\")).then(function (res) {\n          res = res.data;\n\n          if (res.length > _this2.state.transactions.length) {\n            console.log(res.length + \" \" + _this2.state.transactions.length);\n\n            _this2.setState({\n              \"transactions\": res\n            }); // console.log(this.state.transactions);\n\n          }\n        });\n      }, 1000);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var classes = this.props.classes;\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }, React.createElement(Paper, {\n        className: classes.root,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        component: \"h3\",\n        variant: \"h3\",\n        gutterBottom: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }, \"Smart Contracts Audit\"), React.createElement(\"form\", {\n        className: classes.container,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        id: \"userName\",\n        label: \"Smart Contract\",\n        value: this.state.userName,\n        onChange: this.handleChange('userName'),\n        className: classes.textField,\n        margin: \"normal\",\n        variant: \"outlined\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266\n        },\n        __self: this\n      }), React.createElement(ExchangeBox, {\n        transactions: this.state.transactions,\n        userName: this.state.userName,\n        sendTransaction: this.sendTransaction,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275\n        },\n        __self: this\n      }), React.createElement(TextField, {\n        id: \"Transaction\",\n        label: \"Transaction\",\n        value: \"sendether(User, Admin, 10) -> sendtoken(Admin, User, 10)\",\n        onChange: this.handleChange('contextTransaction'),\n        className: classes.textField,\n        margin: \"normal\",\n        variant: \"outlined\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285\n        },\n        __self: this\n      }), React.createElement(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        className: classes.button,\n        onClick: this.callAjax_validate,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 286\n        },\n        __self: this\n      }, \"Validate state\"), React.createElement(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        className: classes.button,\n        onClick: this.callAjax_sendTransaction,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 291\n        },\n        __self: this\n      }, \"send Transaction\"), React.createElement(\"button\", {\n        onClick: \"window.location='http://127.0.0.1:8000/';\",\n        value: \"click here\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296\n        },\n        __self: this\n      })), React.createElement(Review, {\n        responseState: this.state.responseState,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return mainPage;\n}(Component);\n\nmainPage.propTypes = {\n  classes: PropTypes.object.isRequired\n};\nexport default withStyles(styles)(mainPage);","map":{"version":3,"sources":["/home/bnbaotam/Desktop/Bookstore-Blockchain/thuvienbk/templates/pages/auditSmartContract/src/MainPage.js"],"names":["React","Component","Typography","withStyles","PropTypes","Paper","TextField","Button","Review","axios","Link","ExchangeBox","Web3","web3","providers","WebsocketProvider","styles","theme","root","margin","marginTop","spacing","unit","paddingTop","paddingBottom","paddingLeft","paddingRight","width","container","display","flexWrap","textField","marginLeft","marginRight","layoutTransaction","marginBottom","button","fab","rightIcon","IP_address","escrowContract","eth","Contract","tokenContract","events","allEvents","error","event","console","log","mainPage","props","callAjax_sendTransaction","state","contextTransaction","sender","post","senderName","userName","transaction","then","res","data","callAjax_backtohome","callAjax_validate","transactions","map","join","setState","sendethFunc","_from","_to","amount","methods","sendeth","utils","toWei","toString","send","from","gasPrice","gas","value","on","hash","sendtokenFunc","token_address","sendtoken","sendTransaction","transaction_1","responseState","filter","transac","text","slice","length","type","address_token","sendToken","handleChange","prop","target","tokenAddress","checkValidate","myContract","setInterval","get","classes","propTypes","object","isRequired"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport { withStyles } from '@material-ui/core/styles';\nimport PropTypes from 'prop-types';\nimport Paper from '@material-ui/core/Paper';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport Review from './Review.js';\nimport axios from 'axios';\nimport Link from '@material-ui/core/Link';\nimport ExchangeBox from './ExchangeBox.js';\nimport Web3 from 'web3';\nconst web3 = new Web3(new Web3.providers.WebsocketProvider(\"ws://localhost:7545\"));\n\nconst styles = theme =>( {\n    root: {\n        margin : \"auto\",\n        marginTop : theme.spacing.unit * 10,\n        paddingTop: theme.spacing.unit * 2,\n        paddingBottom: theme.spacing.unit * 2,\n        paddingLeft: theme.spacing.unit * 2,\n        paddingRight: theme.spacing.unit * 2,\n        width : \"95%\"\n    },\n    container: {\n        display: 'inline',\n        flexWrap: 'wrap',\n    },\n    textField: {\n        marginLeft: theme.spacing.unit,\n        marginRight: theme.spacing.unit,\n        width: \"100%\"\n    },\n    layoutTransaction : {\n\n        paddingTop: theme.spacing.unit * 2,\n        paddingBottom: theme.spacing.unit * 2,\n        paddingLeft: theme.spacing.unit * 2,\n        paddingRight: theme.spacing.unit * 2,\n        marginTop : theme.spacing.unit*3,\n        marginBottom : theme.spacing.unit*3,\n        marginLeft : \"20%\",\n        marginRight : \"20%\",\n\n    },\n    button: {\n        margin: theme.spacing.unit,\n    },\n    fab: {\n        margin: theme.spacing.unit*2,\n    },\n    rightIcon: {\n        margin: theme.spacing.unit,\n    },\n});\nconst IP_address = \"172.28.247.94\";\nconst escrowContract = new web3.eth.Contract([{\"constant\":false,\"inputs\":[{\"name\":\"_from\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"ether_amount\",\"type\":\"uint256\"}],\"name\":\"sendeth\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\",\"funcName\":\"sendeth(address,address,uint256)\",\"signature\":\"0x5ff49ce3\"},{\"constant\":false,\"inputs\":[{\"name\":\"_from\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_tokenAddress\",\"type\":\"address\"},{\"name\":\"token_amount\",\"type\":\"uint256\"}],\"name\":\"sendtoken\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"funcName\":\"sendtoken(address,address,address,uint256)\",\"signature\":\"0xe5a1f214\"},{\"inputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\",\"signature\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"number_line\",\"type\":\"uint256\"}],\"name\":\"check\",\"type\":\"event\",\"funcName\":\"check(uint256)\",\"signature\":\"0x5f72f450c381493c8b88f0bcbf2bbe88a1ad56665696daa7cb7349917afdd320\"}]\n    ,\"0xE5a1EA9bEEd9c050ad16EB656F21612309DF2aD9\");\n\nconst tokenContract = new web3.eth.Contract([{\"constant\":true,\"inputs\":[],\"name\":\"name\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\",\"funcName\":\"name()\",\"signature\":\"0x06fdde03\"},{\"constant\":false,\"inputs\":[{\"name\":\"_spender\",\"type\":\"address\"},\n        {\"name\":\"tokens\",\"type\":\"uint256\"}],\"name\":\"approve\",\"outputs\":[{\"name\":\"success\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"funcName\":\"approve(address,uint256)\",\"signature\":\"0x095ea7b3\"},{\"constant\":false,\"inputs\":[{\"name\":\"_from\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"tokens\",\"type\":\"uint256\"}],\"name\":\"transferFrom\",\"outputs\":[{\"name\":\"success\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"funcName\":\"transferFrom(address,address,uint256)\",\"signature\":\"0x23b872dd\"},{\"constant\":true,\"inputs\":[],\n    \"name\":\"decimals\",\"outputs\":[{\"name\":\"\",\"type\":\"uint8\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\",\"funcName\":\"decimals()\",\"signature\":\"0x313ce567\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tokenOwner\",\"type\":\"address\"}],\"name\":\"balanceOf\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\",\"funcName\":\"balanceOf(address)\",\"signature\":\"0x70a08231\"},{\"constant\":true,\"inputs\":[],\"name\":\"symbol\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\",\"funcName\":\"symbol()\",\"signature\":\"0x95d89b41\"},{\"constant\":false,\"inputs\":[{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"tokens\",\"type\":\"uint256\"}],\n    \"name\":\"transfer\",\"outputs\":[{\"name\":\"success\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\",\"funcName\":\"transfer(address,uint256)\",\"signature\":\"0xa9059cbb\"},{\"constant\":true,\"inputs\":[{\"name\":\"tokenOwner\",\"type\":\"address\"},{\"name\":\"spender\",\"type\":\"address\"}],\"name\":\"allowance\",\"outputs\":[{\"name\":\"remaining\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\",\"funcName\":\"allowance(address,address)\",\"signature\":\"0xdd62ed3e\"},{\"inputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\",\"signature\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"from\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"tokens\",\"type\":\"uint256\"}],\"name\":\"Transfer\",\"type\":\"event\",\n    \"funcName\":\"Transfer(address,address,uint256)\",\"signature\":\"0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\"},\n    {\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"tokenOwner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"spender\",\"type\":\"address\"},{\"indexed\":false,\n        \"name\":\"tokens\",\"type\":\"uint256\"}],\"name\":\"Approval\",\"type\":\"event\",\"funcName\":\"Approval(address,address,uint256)\",\"signature\":\"0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925\"}],\"0xb4D6d66d76896D99F0A52c8d6C010cEb401F9d5A\");\n\ntokenContract.events.allEvents((error, event) => {\n    if (error) {\n        console.error(error);\n        return false;\n    }\n\n    console.log(event);\n});\n\nescrowContract.events.allEvents((error, event) => {\n    if (error) {\n        console.error(error);\n        return false;\n    }\n\n    console.log(event);\n});\n\nclass mainPage extends Component{\n    constructor(props){\n        super(props);\n        this.state = {\n            contextTransaction : '',\n            responseState : [],\n            transactions : [],\n            userName : '',\n            tokenAddress : '',\n            checkValidate : '' ,\n        };\n        const myContract = '';\n    };\n\n\n    componentDidMount() {\n        setInterval(() => {\n            axios.get(`http://${IP_address}:3001/refresh`).then(res => {\n                res =res.data;\n                if( res.length > this.state.transactions.length) {\n                    console.log(res.length + \" \" + this.state.transactions.length);\n\n                    this.setState({\"transactions\": res});\n\n                    // console.log(this.state.transactions);\n                }\n            })\n        },1000);\n    }\n\n    callAjax_sendTransaction = () => {\n        console.log(\"send\");\n        if (this.state.contextTransaction !== \"\" && this.state.sender !== \"\") {\n            axios.post(`http://${IP_address}:3001/sendTransaction`, {\n                    senderName : this.state.userName,\n                    transaction: this.state.contextTransaction\n            }).then(res => {\n                console.log(res.data);\n            })\n        }\n    };\n\t\n    callAjax_backtohome = () => {\n    \n\n}\n    callAjax_validate = () => {\n            axios.post(`http://${IP_address}:3001/validate`, {\n                transactions : this.state.transactions.map(transaction => transaction.transaction).join(\"\")\n            }).then(res => {\n                console.log(res.data);\n                this.setState({\"responseState\": res.data});\n            })\n    };\n\n    sendethFunc = (_from, _to, amount) => {\n        console.log(\"send eth \" + _from + \" \" + _to + \" \" + amount);\n        escrowContract.methods.sendeth(_from,_to,web3.utils.toWei(amount,'ether').toString())\n            .send({from : _from, gasPrice : \"100000000000\", gas : \"4712388\", value : web3.utils.toWei(amount,'ether').toString()})\n            .on('transactionHash', (hash) => {\n                console.log(hash);\n            })\n    };\n\n    sendtokenFunc= (_from, _to, token_address , amount) => {\n        console.log(\"send token \" + _from + \" \" + _to + \" \"+token_address +\" \" + amount);\n\n        escrowContract.methods.sendtoken(_from,_to,token_address, amount)\n            .send({from : _from, gasPrice : \"100000000000\", gas : \"4712388\"})\n            .on('transactionHash', (hash) => {\n                console.log(hash);\n            })\n    };\n\n// # {\n//     #     transaction : {\n//         #         \"text\" : ...,\n//         #         \"type\" : ...,\n//         #         \"_from\" : ...,\n//         #         \"_to\" : ...,\n//         #         \"address_token\" : ...,\n//         #         \"amount\" : ...,\n//         #     },\n//     #     'account_state' : functools.reduce\n// # }\n\n    sendTransaction = (transaction_1) => {\n        let transaction;\n        console.log(\"aaaaaa\");\n        if (this.state.responseState !== '') {\n\n            let responseState = this.state.responseState;\n            transaction = responseState.filter( transac => {\n                console.log(transac.transaction.text,transaction_1.slice(0,transaction_1.length-1));\n                return transac.transaction.text === transaction_1.slice(0,transaction_1.length-1); });\n            // console.log(JSON.stringify(transaction));\n\n            transaction = transaction[0].transaction ;\n            // console.log(\"#\"+ transaction);\n            if (transaction.type === \"sendeth\") {\n                this.sendethFunc(transaction._from , transaction._to, transaction.amount);\n            }\n            else if (transaction.type === \"sendtoken\") {\n                console.log(transaction);\n                // token thừa , và khaognr trống , phải bỏ đi\n                this.sendtokenFunc(transaction._from , transaction._to, transaction.address_token.slice(1,transaction.address_token.length-1), transaction.amount);\n            }\n            else{\n                console.log(\"line 161\");\n            }\n        }\n    };\n\n    sendToken = () => {\n\n        // escrowContract.methods.sendeth(\"0x6462a0ab9e11F8B47ee153e46E4c3f5f9593ece0\",\"0x8D26738a7bECC37ed5D100639d080FB9835E1008\",web3.utils.toWei(\"1\",\"ether\").toString())\n        //     .send({from : \"0x6462a0ab9e11F8B47ee153e46E4c3f5f9593ece0\", gasPrice : \"100000000000\", gas : \"4712388\", value : web3.utils.toWei(\"1\",\"ether\").toString()})\n        //     .on('transactionHash', (hash) => {\n        //         console.log(hash);\n        //     });\n\n        // escrowContract.methods.sendtoken(\"0x8D26738a7bECC37ed5D100639d080FB9835E1008\",\"0x6462a0ab9e11F8B47ee153e46E4c3f5f9593ece0\",\"0xb4D6d66d76896D99F0A52c8d6C010cEb401F9d5A\", \"10000\")\n        //     .send({from : \"0x8D26738a7bECC37ed5D100639d080FB9835E1008\", gasPrice : \"100000000000\", gas : \"3200000\"})\n        //     .then(res => {\n        //         console.log(\"@@@\"+JSON.stringify(res));\n        //     })\n        //     .catch(error  => {\n        //         console.log(error);\n        //     });\n\n        // tokenContract.methods.balanceOf(\"0x6462a0ab9e11F8B47ee153e46E4c3f5f9593ece0\")\n        //     .call({from: \"0x6462a0ab9e11F8B47ee153e46E4c3f5f9593ece0\", gasPrice: \"100000000000\", gas: \"4712388\"})\n        //     .then( res => {\n        //         console.log(\"# \" +res);\n        //     });\n\n        // tokenContract.methods.transfer(\"0x8D26738a7bECC37ed5D100639d080FB9835E1008\", \"100000000\")\n        //     .send({from: \"0x87616A71Ae0B412e402D846fae89dBF57a32031e\", gasPrice: \"100000000000\", gas: \"4712388\"})\n        //     .on('transactionHash', (hash) => {\n        //         console.log(hash);\n        //     })\n\n\n        // tokenContract.methods.approve(\"0xE5a1EA9bEEd9c050ad16EB656F21612309DF2aD9\",\"10000\")\n        //     .send({from: \"0x8D26738a7bECC37ed5D100639d080FB9835E1008\", gasPrice: \"100000000000\", gas: \"4712388\"})\n        //     .then( res => {\n        //         console.log(\"# \" +res);\n        //     });\n\n        // tokenContract.methods.allowance(\"0x8D26738a7bECC37ed5D100639d080FB9835E1008\",\"0xE5a1EA9bEEd9c050ad16EB656F21612309DF2aD9\")\n        //     .call({from: \"0x8D26738a7bECC37ed5D100639d080FB9835E1008\", gasPrice: \"100000000000\", gas: \"4712388\"})\n        //     .then( res => {\n        //         console.log(\"# \" +res);\n        //     });\n        //\n        // tokenContract.methods.transferFrom(\"0x8D26738a7bECC37ed5D100639d080FB9835E1008\",\"0x30D75Ed05305A0EEB230f2f8adDE680897751fF0\",\"10000\")\n        //     .send({from: \"0x30D75Ed05305A0EEB230f2f8adDE680897751fF0\", gasPrice: \"100000000000\", gas: \"4712388\"})\n        //     .then( res => {\n        //         console.log(\"# \" +res);\n        //     });\n\n        // web3.eth.sendTransaction({\n        //     from: \"0x87616A71Ae0B412e402D846fae89dBF57a32031e\",\n        //     to: \"0xb71381649157D04DDAde46263498218CCDA74C54\",\n        //\n        //     value: web3.utils.toWei(\"3\",\"ether\")\n        // })\n    };\n    handleChange = prop => event => {\n            this.setState({[prop] : event.target.value});\n    };\n    render() {\n        const {classes} = this.props;\n        return (\n            <React.Fragment>\n                <Paper className={classes.root}>\n                    <Typography component=\"h3\" variant=\"h3\" gutterBottom>\n                        Smart Contracts Audit\n                    </Typography>\n                    <form className={classes.container}>\n                        <TextField\n                            id=\"userName\"\n                            label=\"Smart Contract\"\n                            value={this.state.userName}\n                            onChange={this.handleChange('userName')}\n                            className={classes.textField}\n                            margin=\"normal\"\n                            variant=\"outlined\"\n                        />\n                        <ExchangeBox transactions={this.state.transactions} userName={this.state.userName} sendTransaction={this.sendTransaction}/>\n                        <TextField\n                            id=\"Transaction\"\n                            label=\"Transaction\"\n                            value={\"sendether(User, Admin, 10) -> sendtoken(Admin, User, 10)\"}\n                            onChange={this.handleChange('contextTransaction')}\n                            className={classes.textField}\n                            margin=\"normal\"\n                            variant=\"outlined\"\n                        />\n                        <br/>\n                        <Button variant=\"contained\" color=\"primary\" className={classes.button}\n                                onClick={this.callAjax_validate}>\n                            Validate state\n                        </Button>\n\n                        <Button variant=\"contained\" color=\"primary\" className={classes.button}\n                                onClick={this.callAjax_sendTransaction}>\n                            send Transaction\n                        </Button>\n\t\n                         <button onClick=\"window.location='http://127.0.0.1:8000/';\" value=\"click here\" />\n                        {/*<Button variant=\"contained\" color=\"primary\" className={classes.button}*/}\n                                {/*onClick={this.sendToken}>*/}\n                            {/*watch*/}\n                        {/*</Button>*/}\n\n                        {/*<Button variant=\"contained\" color=\"primary\" className={classes.button}*/}\n                                {/*onClick={this.sendToken}>*/}\n                            {/*send token*/}\n                        {/*</Button>*/}\n                    </form>\n                    <Review responseState={this.state.responseState}/>\n                </Paper>\n            </React.Fragment>\n        );\n    }\n}\nmainPage.propTypes = {\n    classes: PropTypes.object.isRequired,\n};\nexport default withStyles(styles)(mainPage);\n"]},"metadata":{},"sourceType":"module"}